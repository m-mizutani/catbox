package model

// ScanType indicates who creates the report
type ScanType string

const (
	// ScanTypeTrivy indicates that report is generated by trivy
	ScanTypeTrivy ScanType = "trivy"
)

type VulnStatus string

const (
	VulnStatusNew       = "new"
	VulnStatusIgnore    = "ignored"
	VulnStatusMitigated = "mitigated"
	VulnStatusFixed     = "fixed"
)

// VulnInfo presents Vulnerability Information (title, package name, fixed version, etc)
type VulnInfo struct {
	VulnID       string
	PkgType      string
	PkgName      string
	FixedVersion string
	CVSS         map[string]string
	Title        string
	Description  string
}

// ScanReport presents S3 pointer of scan report
type ScanReport struct {
	ReportID string

	Image

	// Scan log
	ScanType    ScanType
	RequestedAt int64
	RequestedBy string
	InvokedAt   int64
	ScannedAt   int64

	// Output to
	OutputTo S3Path
}

// RepoVulnStatus presents each vulnerability status of repository by repository (registry + repository + tag).
type RepoVulnStatus struct {
	// Parameters required
	Image
	VulnID    string
	UpdatedAt int64
	Status    VulnStatus
	ScanType  ScanType

	// Trivy based parameters
	PkgSource        string
	PkgName          string
	PkgType          string
	InstalledVersion string
	FixedVersion     string
}
